(in-package :compiler)

(defun parse-body (body look-docstring-p)
  (let ((declares '())
        (docstring nil))
    (do ((forms body (rest forms)))
        ((null forms)
         (values nil declares docstring))
      (let ((form (first forms)))
        (cond ((and (consp form)
                    (eq 'declare (first form)))
               (setf declares (append (rest form) declares)))
              ((and (stringp form) look-docstring-p (rest forms))
               (setq docstring form))
              (t
               (return (values forms declares docstring))))))))
